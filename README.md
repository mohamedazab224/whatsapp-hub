# WhatsApp Hub - ููุญุฉ ุชุญูู WhatsApp ุงููุชูุงููุฉ

ููุตุฉ ุงุญุชุฑุงููุฉ ูุขููุฉ ูุณุฑูุนุฉ ูุฅุฏุงุฑุฉ WhatsApp ูุน ุฏุนู ูุงูู ูููุณุงุฆุท ูุงูุฑุณุงุฆู ูุงูุนูููุงุช ุงูุขููุฉ ูุงูุชุญุฏูุซุงุช ุงููุนููุฉ.

## โจ ุงููููุฒุงุช ุงูุฑุฆูุณูุฉ

- **ุงููุตุงุฏูุฉ ุงูุขููุฉ 100%**: ูุธุงู ูุตุงุฏูุฉ Supabase ูุชูุฏู ูุน ุฏุนู Google OAuth
- **ุฅุฏุงุฑุฉ ุงูุฌูุงุช ุงูุญููููุฉ**: ุฅุฏุงุฑุฉ ุดุงููุฉ ููุนููุงุก ูุน ุชุงุฑูุฎ ุงูุฑุณุงุฆู ุงููุงูู
- **ุฅุฏุงุฑุฉ ุงูุฑุณุงุฆู**: ุฅุฑุณุงู ูุงุณุชูุจุงู ุฑุณุงุฆู ุญููููุฉ ูุน ุฏุนู ุงููุณุงุฆุท
- **ุฅุฏุงุฑุฉ ุงูุฃุฑูุงู**: ุฑุจุท ูุฅุฏุงุฑุฉ ุฃุฑูุงู WhatsApp Business
- **ุณูุฑ ุงูุนูู**: ุฅูุดุงุก ุนูููุงุช ุขููุฉ ุฐููุฉ
- **ุงูุชุญุฏูุซุงุช ุงููุนููุฉ**: ุชุญุฏูุซุงุช ููุฑูุฉ ููุจูุงูุงุช ูุน Supabase Realtime
- **ุงูุชุญูููุงุช**: ุฅุญุตุงุฆูุงุช ููุตูุฉ ุนู ุงูุฃุฏุงุก ูุงูุฑุณุงุฆู
- **ุงูุฃูุงู ุงููุชูุฏู**: Row Level Security ูุงูุชุดููุฑ ูุงูู rate limiting
- **ุงูุฃุฏุงุก ุงูุณุฑูุน**: Caching ูุชูุฏู ู Pagination
- **ุงูุณุฌูุงุช ุงูุดุงููุฉ**: ุชุณุฌูู ูุงูู ูุฌููุน ุงูุฃุญุฏุงุซ ูุงูุฃุฎุทุงุก

## ๐๏ธ ุงูุจููุฉ ุงููุนูุงุฑูุฉ

```
โโโ app/
โ   โโโ api/                    # API routes ุญููููุฉ
โ   โ   โโโ stats/
โ   โ   โโโ contacts/
โ   โ   โโโ messages/
โ   โ   โโโ numbers/
โ   โ   โโโ workflows/
โ   โ   โโโ ...
โ   โโโ auth/                   # ูุณุงุฑุงุช ุงููุตุงุฏูุฉ
โ   โโโ login/                  # ุตูุญุฉ ุชุณุฌูู ุงูุฏุฎูู
โ   โโโ (dashboard)/            # ุตูุญุงุช ููุญุฉ ุงูุชุญูู
โ   โโโ layout.tsx
โโโ lib/
โ   โโโ supabase/
โ   โ   โโโ server.ts           # ุนููู Supabase ุงูุฎุงุฏู
โ   โ   โโโ client.ts           # ุนููู Supabase ุงููุชุตูุญ
โ   โ   โโโ middleware.ts       # ูุนุงูุฌุฉ ุงูุฌูุณุฉ
โ   โ   โโโ query-builder.ts    # ุจูุงุก ุงูุงุณุชุนูุงูุงุช
โ   โ   โโโ error-handler.ts    # ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก
โ   โโโ auth-helpers.ts         # ุฏูุงู ุงููุตุงุฏูุฉ ูุงูุชูููุถ
โ   โโโ validators.ts           # ุงูุชุญูู ูู ุงูุจูุงูุงุช
โ   โโโ cache.ts                # ุฅุฏุงุฑุฉ ุงูู cache
โ   โโโ realtime.ts             # ุงูุงุดุชุฑุงูุงุช ุงููุนููุฉ
โ   โโโ system-logs.ts          # ุชุณุฌูู ุงูุฃุญุฏุงุซ
โ   โโโ api-wrapper.ts          # wrapper ููู API ูุน ุงูุฃูุงู
โ   โโโ rate-limit.ts           # ุชุญุฏูุฏ ูุนุฏู ุงูุทูุจุงุช
โ   โโโ webhook-security.ts     # ุฃูุงู ุงูููุจ ูููุณ
โ   โโโ ...
โโโ hooks/
โ   โโโ use-data.ts             # ุฌูุจ ุงูุจูุงูุงุช
โ   โโโ use-realtime.ts         # ุชุญุฏูุซุงุช ูุนููุฉ ุญููููุฉ
โ   โโโ ...
โโโ components/                  # ููููุงุช React
```

## ๐ ุงูุจุฏุก ุงูุณุฑูุน

### ุงููุชุทูุจุงุช

- Node.js 18+
- pnpm (ุฃู npm/yarn)
- ุญุณุงุจ Supabase ููุนู

### ุงูุชุซุจูุช ูุงูุชุดุบูู

```bash
# 1. ุงุณุชูุณุงุฎ ุงููุดุฑูุน
git clone <repo-url>
cd whatsapp-hub

# 2. ุชุซุจูุช ุงูููุชุจุงุช
pnpm install

# 3. ูุณุฎ ููู ุงูุจูุฆุฉ
cp .env.example .env.local

# 4. ุฅุถุงูุฉ Supabase credentials ุฅูู .env.local
# - NEXT_PUBLIC_SUPABASE_URL
# - NEXT_PUBLIC_SUPABASE_ANON_KEY
# - SUPABASE_SERVICE_ROLE_KEY

# 5. ุชุดุบูู ุฎุงุฏู ุงูุชุทููุฑ
pnpm dev

# 6. ุงููุตูู ุฅูู ุงููุดุฑูุน
# ุงูุชุญ ุงููุชุตูุญ ุนูู: http://localhost:3000
```

## ๐ ุงูุฃูุงู ูุงูุญูุงูุฉ

### ูููุฒุงุช ุงูุฃูุงู ุงููุทุจูุฉ

1. **ุงููุตุงุฏูุฉ ุงููุชูุฏูุฉ**
   - Supabase Auth ูุน JWT tokens ุขููุฉ
   - ุฏุนู Google OAuth
   - ุฌูุณุงุช ูุญููุฉ ูุน HTTP-only cookies
   - ูุนุงูุฌุฉ ุขููุฉ ููุฃุฎุทุงุก ุจุฏูู ุชุณุฑูุจ ุงููุนูููุงุช

2. **ุงูุชูููุถ ูุงูุตูุงุญูุงุช**
   - Row Level Security (RLS) ุนูู ุฌููุน ุงูุฌุฏุงูู
   - ุงูุชุญูู ูู ุงููุตูู ูููุดุฑูุน ููู ุทูุจ
   - ุตูุงุญูุงุช ูููุตูุฉ ููู ุนูููุฉ
   - ููุน ุงููุตูู ุบูุฑ ุงููุตุฑุญ

3. **ุชุญุฏูุฏ ูุนุฏู ุงูุทูุจุงุช**
   - Rate Limiting ูุฌููุน endpoints
   - ุญูุงูุฉ ูู ูุฌูุงุช Brute Force
   - ุชุชุจุน ูุญุงููุงุช ุงูุฏุฎูู ุงููุงุดูุฉ
   - ุฅุนุงุฏุฉ ูุญุงููุฉ ุฐููุฉ

4. **ุงูุชุญูู ูู ุงูุตุญุฉ ุงูุฏููู**
   - Zod schemas ููุชุญูู ูู ุงูุจูุงูุงุช
   - ุงูุชุญูู ูู ุงููุฏุฎูุงุช ุนูู ุงูุฎุงุฏู
   - ุฑุณุงุฆู ุฎุทุฃ ุขููุฉ
   - ููุน injection attacks

5. **ุฃูุงู ุงูููุจ ูููุณ**
   - ุชูููุน HMAC SHA-256
   - ุงูุชุญูู ูู ุงูุชูููุน ููู ุทูุจ
   - timing-safe comparison
   - ููุน replay attacks

6. **ุงูุชุณุฌูู ูุงููุฑุงูุจุฉ**
   - ุชุณุฌูู ุฌููุน ุฃุญุฏุงุซ ุงูุฃูุงู
   - ุชุชุจุน ูุญุงููุงุช ุงูุฏุฎูู
   - ุชุณุฌูู ุงูุฃุฎุทุงุก ูุน ุงูุณูุงู
   - ุฅูุฐุงุฑุงุช ุงูุฃูุดุทุฉ ุงููุฑูุจุฉ

## ๐ ูุงุนุฏุฉ ุงูุจูุงูุงุช

### ุงูุฌุฏุงูู ุงููุณุชุฎุฏูุฉ

- `users` - ุจูุงูุงุช ุงููุณุชุฎุฏููู
- `projects` - ุงููุดุงุฑูุน (ูุงุญุฏ ููู ูุณุชุฎุฏู)
- `contacts` - ุฌูุงุช ุงูุงุชุตุงู
- `messages` - ุงูุฑุณุงุฆู ุงููุนููุฉ
- `whatsapp_numbers` - ุฃุฑูุงู WhatsApp Business
- `workflows` - ุงูุนูููุงุช ุงูุขููุฉ
- `templates` - ููุงูุจ ุงูุฑุณุงุฆู
- `webhook_endpoints` - ููุงุท ููุงูุฉ ุงูููุจ ูููุณ
- `system_logs` - ุณุฌูุงุช ุงููุธุงู ุงููุงููุฉ

### Row Level Security (RLS)

ุฌููุน ุงูุฌุฏุงูู ูุญููุฉ ุจู RLS:
- ูู ูุณุชุฎุฏู ูุฑู ููุท ุจูุงูุงุช ูุดุฑูุนู
- ุงูุนูููุงุช ุงูุญุณุงุณุฉ ูุญููุฉ ุจู service role
- ูุง ูููู ุงููุตูู ูุจูุงูุงุช ุงููุณุชุฎุฏููู ุงูุขุฎุฑูู

## ๐ ุงูุชุญุฏูุซุงุช ุงููุนููุฉ

ุงุณุชุฎุฏู hooks ุงููุนููุฉ ููุชุญุฏูุซุงุช ุงูุญูุฉ ุงูููุฑูุฉ:

```typescript
import { useRealtimeContacts } from "@/hooks/use-realtime"

export function ContactsList({ projectId }) {
  const { contacts, isLoading, mutate } = useRealtimeContacts(projectId)
  
  return (
    <div>
      {contacts.map(contact => (
        <div key={contact.id}>{contact.name}</div>
      ))}
    </div>
  )
}
```

## ๐ API Routes (ุงูุญููููุฉ)

### Contacts (ุฌูุงุช ุงูุงุชุตุงู)
- `GET /api/contacts` - ุฌูุจ ุฌูุงุช ุงูุงุชุตุงู ูุน pagination
- `POST /api/contacts` - ุฅูุดุงุก ุฌูุฉ ุงุชุตุงู
- `GET /api/contacts/:id` - ุฌูุฉ ุงุชุตุงู ูุนููุฉ

### Messages (ุงูุฑุณุงุฆู ุงูุญููููุฉ)
- `GET /api/messages` - ุฌูุจ ุงูุฑุณุงุฆู
- `POST /api/messages` - ุฅุฑุณุงู ุฑุณุงูุฉ
- `GET /api/messages/:id` - ุฑุณุงูุฉ ูุนููุฉ

### Numbers (ุงูุฃุฑูุงู)
- `GET /api/numbers` - ุฌูุจ ุงูุฃุฑูุงู ุงููุชุตูุฉ
- `POST /api/numbers` - ุฅุถุงูุฉ ุฑูู

### Stats (ุงูุฅุญุตุงุฆูุงุช)
- `GET /api/stats` - ุฅุญุตุงุฆูุงุช ุงููุดุฑูุน

### Workflows (ุณูุฑ ุงูุนูู)
- `GET /api/workflows` - ุฌูุจ ุณูุฑ ุงูุนูู
- `POST /api/workflows` - ุฅูุดุงุก ุณูุฑ ุนูู

## โก ุงูุฃุฏุงุก ูุงูุชุญุณููุงุช

### Caching ุงูุฐูู
```typescript
import { invalidateCache, CACHE_TAGS } from "@/lib/cache"

// ุฅุจุทุงู ุงูู cache ุนูุฏ ุงูุชุญุฏูุซ
await invalidateCache(CACHE_TAGS.CONTACTS_BY_PROJECT(projectId))
```

### Pagination ูุนุงูุฉ
```typescript
const { data, count, totalPages } = await paginatedFetch(
  "contacts",
  1, // page
  20, // limit
  { project_id: projectId }
)
```

### Batch Fetch ููุฃุฏุงุก
```typescript
const contacts = await batchFetch("contacts", ids, { project_id })
```

## ๐งช ุงูุงุฎุชุจุงุฑ

```bash
# ุชุดุบูู ุฌููุน ุงูุงุฎุชุจุงุฑุงุช
pnpm test

# ุงุฎุชุจุงุฑุงุช ูุญุฏุฏุฉ
pnpm test basic-auth
pnpm test webhook-security
pnpm test logger
```

## ๐ ุงูุชูุซูู

### Validation ูุน Zod

```typescript
import { validateData, contactSchema } from "@/lib/validators"

const contact = validateData(req.body, contactSchema)
// ุณูุฑูู ValidationError ุฅุฐุง ูุงูุช ุงูุจูุงูุงุช ุบูุฑ ุตุญูุญุฉ
```

### Logging ุงูุดุงูู

```typescript
import { logSystemEvent, logAuthEvent, logApiError } from "@/lib/system-logs"

// ุชุณุฌูู ุญุฏุซ ุฃูุงู
await logAuthEvent(userId, projectId, "login", true)

// ุชุณุฌูู ุฎุทุฃ API
await logApiError(projectId, userId, "/api/messages", 500, "Database error")
```

### ูุนุงูุฌุฉ ุงูุฃุฎุทุงุก ุงูุขููุฉ

```typescript
import { withApiWrapper } from "@/lib/api-wrapper"

export const GET = withApiWrapper(
  async (req) => {
    // ููุฏู ููุง - ุงููุตุงุฏูุฉ ูุงูุฃูุงู ุชุนุงููุช ุชููุงุฆูุงู
    return NextResponse.json({ data: "success" })
  },
  { requireAuth: true, rateLimit: { windowMs: 60000, max: 30 } }
)
```

## ๐ ุงููุดุฑ ุนูู Vercel

```bash
# 1. ุฑุจุท ุงููุดุฑูุน
vercel link

# 2. ุฅุถุงูุฉ ูุชุบูุฑุงุช ุงูุจูุฆุฉ
vercel env add NEXT_PUBLIC_SUPABASE_URL
vercel env add NEXT_PUBLIC_SUPABASE_ANON_KEY
vercel env add SUPABASE_SERVICE_ROLE_KEY

# 3. ุงููุดุฑ
vercel deploy --prod
```

## ๐ ูุฑุงูุจุฉ ุงููุธุงู

### ุนุฑุถ ุงูุณุฌูุงุช
```typescript
import { getSystemLogs } from "@/lib/system-logs"

const logs = await getSystemLogs(projectId, { 
  category: "security",
  limit: 100 
})
```

### ุงูููุงููุณ ุงููุชุงุญุฉ
- ุนุฏุฏ ุงูุฑุณุงุฆู ุงููุฑุณูุฉ/ุงููุณุชูุจูุฉ
- ุนุฏุฏ ุฌูุงุช ุงูุงุชุตุงู ุงููุดุทุฉ
- ูุนุฏู ูุฌุงุญ ุงูุนูููุงุช
- ุฃุฎุทุงุก ุงููุธุงู ูุงูุชุญุฐูุฑุงุช

## ๐ ุงุณุชูุดุงู ุงูุฃุฎุทุงุก

### ุงููุดุงูู ุงูุดุงุฆุนุฉ

**1. ุฎุทุฃ ูู ุงูุงุชุตุงู ุจู Supabase**
- ุชุญูู ูู `.env.local` ูุญุชูู ุนูู credentials ุตุญูุญ
- ุชุฃูุฏ ูู ุชูุนูู Supabase
- ุชุญูู ูู URL ู keys

**2. ูุดุงูู ูู ุงููุตุงุฏูุฉ**
- ุงูุณุญ ูููุงุช ุชุนุฑูู ุงูุงุฑุชุจุงุท: `Cmd+Shift+Delete`
- ุญุงูู ุชุณุฌูู ุงูุฎุฑูุฌ ูุงูุฏุฎูู ูุฌุฏุฏุงู
- ุชุญูู ูู RLS policies

**3. ุจุทุก ุงูุชุทุจูู**
- ุงูุญุต Network tab ูู DevTools
- ุชุญูู ูู Realtime subscriptions
- ุงุณุชุฎุฏู React DevTools ููุชุญูู ูู rerenders

## ๐ ุงูุชุฑุฎูุต

ูุฐุง ุงููุดุฑูุน ูุฑุฎุต ุชุญุช MIT License

---

**ููุงุญุธุฉ**: ูุฐุง ุงููุดุฑูุน ุชู ุชูุธููู ูุชุญุณููู ููููู:
โ ูุธูู ููุงุจู ููุตูุงูุฉ
โ ุณุฑูุน ุงูุฃุฏุงุก ูุน caching ู pagination
โ ุขูู 100% ูุน RLS ู rate limiting
โ ุชุญุฏูุซุงุช ูุนููุฉ ุญููููุฉ ูุน Supabase
โ ุฌููุน ุงููุธุงุฆู ุชุนูู ุจุดูู ุญููููุ ููุณ ูููู

